<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Git Versioned PDF Visualizer | bonkerfield</title><meta name="description" content="just your standard information identity spacetime field"><meta itemprop="name" content="will stedden"><meta itemprop="description" content="just your standard information identity spacetime field"><meta itemprop="image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><meta property="og:url" content="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"><meta property="og:type" content="website"><meta property="og:title" content="Git Versioned PDF Visualizer | bonkerfield"><meta property="og:site_name" content="bonkerfield"><meta property="og:description" content="just your standard information identity spacetime field"><meta property="og:image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><meta property="twitter:url" content="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:title" content="Git Versioned PDF Visualizer | bonkerfield"><meta property="twitter:site" content="bonkerfield"><meta property="twitter:description" content="just your standard information identity spacetime field"><meta property="twitter:image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="bonkerfield" href="/feed.xml"><link rel="canonical" href="/2016/06/git-versioned-pdf-visualizer/"><link href="https://fonts.googleapis.com/css?family=Exo" rel="stylesheet"><link rel="webmention" href="https://webmention.io/bonkerfield.org/webmention" /><link rel="pingback" href="https://webmention.io/bonkerfield.org/xmlrpc" /> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-132451521-2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-132451521-2'); </script><link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css' rel='stylesheet'/></head><body id="git-versioned-pdf-visualizer" class="post-layout"><header class="header"> <span><a class="header__title" href="/">bonkerfield</a></span><nav><ul class="header__list"><li><a href="/fiction">fiction</a></li><li><a href="/projects">projects</a></li><li><a href="/essays">essays</a></li><li><a href="/reasons">about</a></li><li><a href="https://will.stedden.org/">contact</a></li><li><a href="/search"><i class="fa fa-search"></i></a></li></ul></nav></header><a style="display:none;" class="p-author h-card" href="http://bonkerfield.org"> <img alt="" src="/assets/images/main/face_prof.jpg"/> will stedden</a><main class="bonk"><div class="post"><article class="h-entry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding-half"><div class="grid-small"><h2 itemprop="name headline p-name">Git Versioned PDF Visualizer</h2><time class="post__date dt-published" datetime="2016-06-20T00:00:00-05:00" itemprop="datePublished">2016·06·20</time> <span class="post__author"> | <a class="p-name u-url" href="http://will.stedden.org" title="about">will stedden</a> </span><p class="post__description p-summary"></p><a class="u-url" style="display:none;" href="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"></a></div></div><div class="post__content section-padding"><div class="grid"><div class="e-content" id="markdown" itemprop="articleBody"> <a href="https://github.com/lots-of-things/git-pdf-viz">jump to the code</a><p> I've been writing a <a href="https://github.com/wmcfadden/theseus" title="my PhD thesis">very long document</a> over the past couple of years. Because I love tracking my own behavior and <a href="https://en.wikipedia.org/wiki/Open_science">Open science</a>, I decided to version control the whole editing process of my thesis on GitHub. Because I've been keeping track of all my updates with git, that means I can monitor all the changes that have gone into my thesis over time. This can also be useful for <a href="http://danaernst.com/using-github-to-coauthor-papers/">collaborating on writing papers</a> too (though my prototypical Luddite advisor would rather do things by emailing <a href="http://www.apple.com/mac/pages/">Mac Pages</a> documents).</p><h4>Git PDF movie maker</h4><p> As a cool way to visualize all the changes, I wrote a series of a couple of scripts that checkout each version and make a movie out of all the .pdfs in the repo over time. Here's the current state (note that the thesis isn't even close to finished yet; I'll update when I get more on it.)</p><div style="text-align:center"><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/mWvQ1Y5uaGc" width="420"></iframe></div><p> If you think you'd like to use this, you can bounce over to the <a href="https://github.com/lots-of-things/git-pdf-viz">git-pdf-viz GitHub repo</a> and download it now. Read on below for more info on how it works, how to modify it, and to see the results of running git-pdf-viz on my thesis.</p><h4>A Real Bash!</h4><p> Writing bash scripts is a party, I know. This entire project is comprised of just a few bash scripts that are meant to be run sequentially (with some editing maybe).</p><ol><li>save_all_pdfs</li><li>pdfs_to_ims</li><li>ims_to_montage</li><li>montage_to_frame</li><li>frame_to_movie</li></ol><h4>Save All PDFs</h4><p> The first script really takes care of the core of this program. There's lots of extra details but the key piece of save_all_pdfs.sh is "git rev-list master," which gives you all the commit ids for your repo. This pseudo-bash shows the general idea:</p><pre>
for commit in $(git rev-list master)
do
    git checkout $commit
    ...copy all pdfs to somewhere safe...
done
</pre><p> "git checkout" updates all the files that are sitting in the project directory locally. So with the list of revisions from "git rev-list master" I can reset the state of my file system to reflect the state at each committed phase of the project. After that, I just need to copy all the files I need (in this case my pdfs) somewhere safe for use later. (<strong>Caveat:</strong> I'm currently only copying pdfs if they have a corresponding latex file because I wanted to ignore any figures that weren't included. You can modify the script accordingly if you need all your pdfs copied.)</p><h4>Playing with pdfs and images</h4><p> The next three scripts rely on <a href="http://ghostscript.com/doc/current/Devices.htm">GhostScript</a> and <a href="http://www.imagemagick.org/script/index.php">ImageMagick suite</a> to jockey our pdfs into a composite image that will eventually be turned into movie frames. You can view the scripts themselves for more details about implementation, but I'll explain the idea behind each script for reference.</p><ul><li><strong>gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOutputFile=merged.pdf *.pdf </strong> uses ghostscript to merge all the saved pdfs together</li><li><strong>convert merged.pdf im/i_%03d.png</strong> converts the merged pdf to a sequence of individual pngs</li><li><strong>montage -mode concatenate -tile 10x i_* ../final.png</strong> stitches all the individual png "pages" into a "montage" panel with 10 columns</li><li><strong>convert "${now}/final.png" -resize 1000x -gravity northwest -background white -extent 1000x700 -colorspace RGB "PNG32:bydate/${now}.png"</strong> rescales each montage and ensures that all images are the same size and colorspace</li><li><strong>mogrify -gravity southeast -pointsize 26 -annotate +10+10 %t *.png</strong> adds a little timestamp (based on the title) in the southeast corner</li></ul><p> At the end of this process there will be a folder named bydate/ with an image for every frame of a movie that's about to get made.</p><h4>Lights, Camera, Action</h4><p> As the final step we use <a href="https://ffmpeg.org/">ffmpeg</a> to convert all of the images into an mp4 movie. This requires two lines because ffmpeg is made to work with numerically sequential files, and my files are named based on their date.</p><pre>
ls *.png | sort -V | xargs -I {} echo "file '{}'" &gt; list.txt
ffmpeg -r 2 -f concat -i list.txt -r 30 -c:v libx264 -pix_fmt yuv420p ../git_pdf_viz.mp4
</pre><p> This is a good example of how compicated ghostscript, ImageMagick, and ffmpeg can be to use. Through all of this there are about 20 extra parameters that have to get passed to each of these programs to make them work properly. I can't explain all of them in detail, so I recommend the individual software's documentation if you find you need to modify these extensively. These are <strong>amazingly</strong> powerful programs that make life so much easier for any kind of batch audiovisual project so I highly encourage getting acquainted with them at some point in your life.</p><p> Have fun, and I hope that this encourages you to use open source version control whenever you write/edit any large document project.</p></div></div></div><div class="section-padding--none"><div class="grid"><hr class="sep" /></div></div><div class="section-padding"><div class="grid-small"><h3 class="post__discussion">Discussion Around the <a href="https://indieweb.org/Webmention">Web</a></h3><div id="webmentions"></div><hr style="margin: 5px 0;" class="sep" /><p>Join the Conversation</p><form target="_blank" name="tweet" action="https://twitter.com/share" method="get"> <input type="hidden" name="original_referer" value="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"> <input type="hidden" name="source" value="bonkerfield"> <textarea style="border-color:#aaa;" id="textar" name="text" maxlength="140"></textarea> <input type="hidden" name="url" value="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"> <button class="btn btn-sm btn-social btn-tw" type="submit" id="button"> <i class="fab fa-twitter"></i> <br/>comment by tweet </button> </form><hr style="margin: 5px 0;" class="sep" /> <form target="_blank" name="tweet" action="https://www.reddit.com/submit" method="get"> <input type="hidden" name="source" value="bonkerfield"> <textarea style="border-color:#aaa;" id="textar" name="title" maxlength="140"></textarea> <button class="btn btn-sm btn-social btn-rd" type="submit" id="button"> <i class="fab fa-reddit-alien"></i> <br/>submit to reddit </button> <input type="hidden" name="url" value="https://bonkerfield.org/2016/06/git-versioned-pdf-visualizer/"> </form> <script src="/assets/js/webmention.min.js"></script></div></div></article></div><section class="related section-padding"><div class="grid-xlarge"><h2 class="related__title">Related</h2><div class="related__container"><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2023/05/fedi-watch-demo/"><figure class="related__img"> <img src="/assets/images/2023/fediwatch_2.png" alt="FEDI-WATCH demo" /></figure><div><h2 class="related__text">FEDI-WATCH demo</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2022/02/scrap-wood-stool/"><figure class="related__img"> <img src="/assets/images/2022/stool_pretty_2.jpg" alt="Scrap Wood Stool on a New Mexico Farm" /></figure><div><h2 class="related__text">Scrap Wood Stool on a New Mexico Farm</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2022/02/google-sheet-hosted-website/"><figure class="related__img"> <img src="/assets/images/2022/google_sheet.png" alt="Building a website on Google Sheets" /></figure><div><h2 class="related__text">Building a website on Google Sheets</h2></div></a></article></div></div></section></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get an update when I post new content.</p><form method="POST" action="https://bonkerfield.us4.list-manage.com/subscribe/post-json?u=68d1146ea8fe327def203f254&amp;id=e88ba623c5&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_68d1146ea8fe327def203f254_e88ba623c5" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__social"><li><a href="https://sigmoid.social/@bonkerfield" rel="me" target="_blank"><i class="fab fa-mastodon"></i></a></li><li><a href="https://www.linkedin.com/in/willstedden" rel="me" target="_blank"><i class="fab fa-linkedin"></i></a></li><li><a href="https://github.com/stedn" rel="me" target="_blank"><i class="fab fa-github"></i></a></li><li><a href="https://www.reddit.com/user/bonkerfield" rel="me" target="_blank"><i class="fab fa-reddit-alien"></i></a></li></ul><div class="posts__pagination"> <span>This site is maintained by <a href="https://will.stedden.org">Will Stedden</a>. All content on this blog is free to use under a creative commons <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a> license</span>. The thoughts behind this content may be used under the terms of Will's <a href="https://will.stedden.org/lisens">'lisens'</a>.</div></div></div></footer><script src="/assets/js/app.min.js"></script> <script> (function() { var links = document.getElementsByTagName('a'); for (var i = 0; i < links.length; i++) { if (/^(http?:)?\/\//.test(links[i].getAttribute('href'))) { links[i].target = '_blank'; } } })(); </script></body></html>
  