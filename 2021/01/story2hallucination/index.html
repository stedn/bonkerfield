<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Story2Hallucination: converting stories to deep learning GAN hallucinated animations | bonkerfield</title><meta name="description" content="just your standard information identity spacetime field"><meta itemprop="name" content="will stedden"><meta itemprop="description" content="Using OpenAI CLIP to generate dynamically evolving images as the text of a story is fed in"><meta itemprop="image" content="https://bonkerfield.org/assets/images/2021/octo.gif"><meta property="og:url" content="https://bonkerfield.org/2021/01/story2hallucination/"><meta property="og:type" content="website"><meta property="og:title" content="Story2Hallucination: converting stories to deep learning GAN hallucinated animations | bonkerfield"><meta property="og:site_name" content="bonkerfield"><meta property="og:description" content="Using OpenAI CLIP to generate dynamically evolving images as the text of a story is fed in"><meta property="og:image" content="https://bonkerfield.org/assets/images/2021/octo.gif"><meta property="twitter:url" content="https://bonkerfield.org/2021/01/story2hallucination/"><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:title" content="Story2Hallucination: converting stories to deep learning GAN hallucinated animations | bonkerfield"><meta property="twitter:site" content="bonkerfield"><meta property="twitter:description" content="Using OpenAI CLIP to generate dynamically evolving images as the text of a story is fed in"><meta property="twitter:image" content="https://bonkerfield.org/assets/images/2021/octo.gif"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="bonkerfield" href="/feed.xml"><link rel="canonical" href="/2021/01/story2hallucination/"><link href="https://fonts.googleapis.com/css?family=Exo" rel="stylesheet"><link rel="webmention" href="https://webmention.io/bonkerfield.org/webmention" /><link rel="pingback" href="https://webmention.io/bonkerfield.org/xmlrpc" /> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-132451521-2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-132451521-2'); </script><link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css' rel='stylesheet'/></head><body id="story2hallucination-converting-stories-to-deep-learning-gan-hallucinated-animations" class="post-layout"><header class="header"> <span><sup><a class="header__leadin" href="https://will.stedden.org">will.stedden ></a> </sup> <a class="header__title" href="/">bonkerfield</a></span><nav><ul class="header__list"><li><a href="https://prof.bonkerfield.org">fiction</a></li><li><a href="/projects">projects</a></li><li><a href="/essays">essays</a></li><li><a href="/reasons">about</a></li><li><a href="https://viewfoil.bonkerfield.org/">contact</a></li><li><a href="/search"><i class="fa fa-search"></i></a></li></ul></nav></header><a style="display:none;" class="p-author h-card" href="http://bonkerfield.org"> <img alt="" src="/assets/images/main/face_prof.jpg"/> will stedden</a><main class="bonk"><div class="post"><article class="h-entry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding-half"><div class="grid-small"><h2 itemprop="name headline p-name">Story2Hallucination: converting stories to deep learning GAN hallucinated animations</h2><time class="post__date dt-published" datetime="2021-01-22T00:00:00-06:00" itemprop="datePublished">2021·01·22</time> <span class="post__author"> | <a class="p-name u-url" href="http://will.stedden.org" title="about">will stedden</a> </span><p class="post__description p-summary">Using OpenAI CLIP to generate dynamically evolving images as the text of a story is fed in</p><a class="u-url" style="display:none;" href="https://bonkerfield.org/2021/01/story2hallucination/"></a></div></div><div class="post__content section-padding"><div class="grid"><div class="e-content" id="markdown" itemprop="articleBody"><p>Late last year, I tried working on a method to use the text from my dynamically updating short story website, <a href="https://bonkerfield.org/attention">a.ttent.io/n</a>, to generate hallucinatory animations. Back then, I was working off of earlier <a href="http://proceedings.mlr.press/v48/reed16.pdf">methods</a> to do this sort of thing and wasn't having great results. But earlier this month OpenAI released a newer method called <a href="https://openai.com/blog/clip/">CLIP</a>, which really improved the text-to-image generation results that I've seen.</p><p>The focus of CLIP itself was originally for standalone image generation, and that seems to be what most people are doing with it. However, working off a CLIP-based package called <a href="https://github.com/lucidrains/big-sleep">BigSleep</a>, I found a pretty cool way to turn paragraphs into quite interesting animations that seem to have at least some connection to the text. As an example, here is an exerpt from the beginning of Franz Kafka's <i>Metamorphosis</i> being used to generate the visuals.</p><small>Warning that there is a decent amount of blinking and flickering in the videos that follow.</small> <iframe width="560" height="400" src="https://www.youtube.com/embed/kSltslbtblw" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Clearly there are segments where the visualization breaks down, but there are surprisingly a couple of spots that actually map pretty well to the underlying text they are trying to describe. At the very least, the images clearly capture Kafka's surreal tone. (dare I call it Kafkaesque?)</p><p>For the next trick, I wanted to try some more positive visual language so I went with a familiar William Wordsworth poem. In the next clip, I show two runs side by side to illustrate how the images randomly decay to noise and need to be periodically reset.</p><iframe width="560" height="400" src="https://www.youtube.com/embed/SOXXQhQf0SE" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Again there are places where the algorithm starts spitting out total noise, but overall, the parts that do connect smoothly are vivid and very pertinent. I want to dive into the details over the next few weeks and figure out where the algorithm goes off the rails, but for now, I just built in a few safe-guards to "reset" it when things get too messy or it sticks on the same shape for too long. You can view <a href="https://www.youtube.com/channel/UCjfbKpAq127UVuFeaepkvWg">my Youtube channel</a> to see more experiments.</p><h4>a.ttent.io/n</h4><p>But my real application was meant to be used on my own short stories. To optimize that, I fine-tuned the parameter selection manually to see if I could get it to produce more consistent video. I used the first paragraph of <a href="https://bonkerfield.org/attention">a.ttent.io/n</a>, and after many rounds of trial and error, I started to get it to pump out artistic renditions of the real features that are mentioned. Take a look.</p><iframe width="560" height="400" src="https://www.youtube.com/embed/9Y-UZquQDf0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Clearly it does well with any mention of octopus, even fictional "harp-toothed" ones.</p><img class="small_img" src="/assets/images/2021/octo.gif" alt="Big Sleep rendered octopus on ocean floor"/><p>But it also renders a wall, glass narcotics cabinet, and bottles pretty well.</p><img src="/assets/images/2021/story2hallucination.png" alt="Big Sleep rendered wall, narcotics in a cabinet, and bottles on a countertop"/><p>"Distribution center" rendered an interesting overhead map view, it seemed.</p><img class="small_img" src="/assets/images/2021/distro_hallucinate.png" alt="Big Sleep rendered overhead view of what could be a distribution center"/><p>But my personal favorite though was the rendering of the dock.</p><img src="/assets/images/2021/docks.gif" alt="Big Sleep rendered docks with fog rolling in over nearby rocks"/><h4>Try it yourself</h4><p>All the code needed for this is in a Google Colab notebook available<a href="https://colab.research.google.com/drive/1yNkvkrHApFR6alyFC1EzhPGHs86yjH1P?usp=sharing">here</a>, and it's also available on <a href="https://github.com/lots-of-things/Story2Hallucination/">github</a> if you'd like to help me make improvements. My notebook is just a modification of <a href="https://colab.research.google.com/drive/1MEWKbm-driRNF8PrU7ogS5o3se-ePyPb?usp=sharing">this one</a> from <a href="https://github.com/lucidrains">Phil Wang</a> that lays out how to use Big Sleep with CLIP weights.</p><p>There's a lot of hacky code that tries to modify parts of Big Sleep from the outside, but the only important modification is just the change to dynamically update the text periodically with this line:</p><code> model.text = all_text_list[epoch].translate(str.maketrans('', '', string.punctuation)) model.encoded_text = tokenize(model.text).cuda() </code><p>Pretty much the rest of the code modifications were just there to get the image to robustly "reset" if it gets stuck looking too similar for too long. This became an issue because sometimes the image converges to a very stable form and stops morphing from there. This is not such a big deal when you are generating one-off images because you can always try again, but when you are trying to dynamically morph from one text prompt to the next, getting stuck means the whole video is lost.</p><p>You can play around with your own texts and let me know what you come up with. There are quite a few parameters to try to optimize to get good results.</p><p>I'd love to see what things happen. If you reference this blog post on twitter or mastodon, then your work will be appended in the comments section.</p><p>And have fun hallucinating!</p></div></div></div><div class="section-padding--none"><div class="grid"><hr class="sep" /></div></div><div class="section-padding"><div class="grid-small"><h3 class="post__discussion">Discussion Around the <a href="https://indieweb.org/Webmention">Web</a></h3><div id="webmentions"></div><hr style="margin: 5px 0;" class="sep" /><p>Join the Conversation</p><form target="_blank" name="tweet" action="https://twitter.com/share" method="get"> <input type="hidden" name="original_referer" value="https://bonkerfield.org/2021/01/story2hallucination/"> <input type="hidden" name="source" value="bonkerfield"> <textarea style="border-color:#aaa;" id="textar" name="text" maxlength="140"></textarea> <input type="hidden" name="url" value="https://bonkerfield.org/2021/01/story2hallucination/"> <button class="btn btn-sm btn-social btn-tw" type="submit" id="button"> <i class="fab fa-twitter"></i> <br/>comment by tweet </button> </form><hr style="margin: 5px 0;" class="sep" /> <form target="_blank" name="tweet" action="https://www.reddit.com/submit" method="get"> <input type="hidden" name="source" value="bonkerfield"> <textarea style="border-color:#aaa;" id="textar" name="title" maxlength="140"></textarea> <button class="btn btn-sm btn-social btn-rd" type="submit" id="button"> <i class="fab fa-reddit-alien"></i> <br/>submit to reddit </button> <input type="hidden" name="url" value="https://bonkerfield.org/2021/01/story2hallucination/"> </form> <script src="/assets/js/webmention.min.js"></script></div></div></article></div><section class="related section-padding"><div class="grid-xlarge"><h2 class="related__title">Related</h2><div class="related__container"><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2021/01/story2hallucination/"><figure class="related__img"> <img src="/assets/images/2021/octo.gif" alt="Story2Hallucination: converting stories to deep learning GAN hallucinated animations" /></figure><div><h2 class="related__text">Story2Hallucination: converting stories to deep learning GAN hallucinated animations</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2020/04/twenty-minute-gpt2-reply-bot/"><figure class="related__img"> <img src="/assets/images/2020/tup_too_real.png" alt="A GPT2+BERT reddit reply bot in 20 minutes" /></figure><div><h2 class="related__text">A GPT2+BERT reddit reply bot in 20 minutes</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2020/02/reddit-bot-gpt2-bert/"><div><h2 class="related__text">How to build a convincing reddit personality with GPT2 and BERT</h2></div></a></article></div></div></section></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get an update when I post new content.</p><form method="POST" action="https://bonkerfield.us4.list-manage.com/subscribe/post-json?u=68d1146ea8fe327def203f254&amp;id=e88ba623c5&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_68d1146ea8fe327def203f254_e88ba623c5" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__social"><li><a href="https://fosstodon.org/@bonkerfield" rel="me" target="_blank"><i class="fab fa-mastodon"></i></a></li><li><a href="https://www.linkedin.com/in/willstedden" rel="me" target="_blank"><i class="fab fa-linkedin"></i></a></li><li><a href="https://github.com/stedn" rel="me" target="_blank"><i class="fab fa-github"></i></a></li><li><a href="https://www.reddit.com/user/bonkerfield" rel="me" target="_blank"><i class="fab fa-reddit-alien"></i></a></li></ul><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank"> <input type="hidden" name="cmd" value="_donations" /> <input type="hidden" name="business" value="3LHDHWRBWMGZA" /> <input type="hidden" name="item_name" value="Help Fund the Quantum Multiverse Bifurcator" /> <input type="hidden" name="currency_code" value="USD" /> <input type="submit" value="donate" name="submit" style="width:15%;min-width:70px;"> <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" /> </form><div class="posts__pagination"> <span>All content on this blog is free to use under a creative commons <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a> license</span></div></div></div></footer><script src="/assets/js/app.min.js"></script> <script> (function() { var links = document.getElementsByTagName('a'); for (var i = 0; i < links.length; i++) { if (/^(http?:)?\/\//.test(links[i].getAttribute('href'))) { links[i].target = '_blank'; } } })(); </script></body></html>
  